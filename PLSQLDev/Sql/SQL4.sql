 

SELECT a.stuno,
       a.PERS_KOR_NM,
       a.SCHREG_MOD_FG AS "학적변동코드",
       SF_BSNS011_CODENM(a.SCHREG_MOD_FG,1) AS "학적변동명칭",
       
       CASE WHEN a.SCHREG_MOD_FG IN ('U030300017','U030300018') 
                 THEN SUBSTR(SF_TEMP202009_TEMP(a.stuno),1,4) || '.' || DECODE(SUBSTR(SF_TEMP202009_TEMP(a.stuno),5,10),'U000200001','1','2') 
                 ELSE '2020.1'
       END AS "등록금납부학기", 
       
       NVL((SELECT REG_TT_AMT FROM ENRO200 
        WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001'        
        AND stuno = a.stuno
       ),0) AS "2020-1학기 등록금액",
       
       CASE WHEN a.SCHREG_MOD_FG IN ('U030300017','U030300018')  
                 THEN (SELECT REG_TT_AMT FROM ENRO200 WHERE SCHYY || SHTM_FG = SF_TEMP202009_TEMP(a.stuno) AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno) 
                 ELSE 0 
       END AS "복귀생납부학기등록금",
       CASE WHEN a.SCHREG_MOD_FG IN ('U030300017','U030300018')  
                 THEN (SELECT SCAL_TT_AMT FROM ENRO200 WHERE SCHYY || SHTM_FG = SF_TEMP202009_TEMP(a.stuno) AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno) 
                 ELSE 0 
       END AS "복귀생납부학기장학금",
       CASE WHEN a.SCHREG_MOD_FG IN ('U030300017','U030300018')  
                 THEN (SELECT REG_TT_AMT - SCAL_TT_AMT FROM ENRO200 WHERE SCHYY || SHTM_FG = SF_TEMP202009_TEMP(a.stuno) AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno) 
                 ELSE 0 
       END AS "복귀생납부학기납입금",
       
       NVL((SELECT REG_TT_AMT FROM ENRO200 
        WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001'        
        AND stuno = a.stuno
       ),0) +       
       CASE WHEN a.SCHREG_MOD_FG IN ('U030300017','U030300018')
                 THEN (SELECT REG_TT_AMT FROM ENRO200 WHERE SCHYY || SHTM_FG = SF_TEMP202009_TEMP(a.stuno) AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno) 
                 ELSE 0 
       END AS "최종등록금액",
       
       NVL((SELECT REG_TT_AMT - SCAL_TT_AMT FROM ENRO200 
        WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001'        
        AND stuno = a.stuno
       ),0) +       
       CASE WHEN a.SCHREG_MOD_FG IN ('U030300017','U030300018')
                 THEN (SELECT REG_TT_AMT - SCAL_TT_AMT FROM ENRO200 WHERE SCHYY || SHTM_FG = SF_TEMP202009_TEMP(a.stuno) AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno) 
                 ELSE 0 
       END AS "최종납입금액" 
FROM temp202009 a 
--WHERE stuno = '2013-10260'
;


SELECT a.stuno,
       a.PERS_KOR_NM,
       a.SCHREG_MOD_FG AS "학적변동코드",
       SF_BSNS011_CODENM(a.SCHREG_MOD_FG,1) AS "학적변동명칭",
       --(SELECT SF_BSNS011_CODENM(SCHREG_MOD_FG,1) FROM ENRO200 WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno) AS "학적변동",
       
       CASE WHEN (SELECT SCHREG_MOD_FG FROM ENRO200 WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno ) IN ('U030300017','U030300018') 
                 THEN SUBSTR(SF_TEMP202009_TEMP(a.stuno),1,4) || '.' || DECODE(SUBSTR(SF_TEMP202009_TEMP(a.stuno),5,10),'U000200001','1','2') 
                 ELSE '2020.1'
       END AS "등록금납부학기", 
       
       NVL((SELECT REG_TT_AMT FROM ENRO200 
        WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001'        
        AND stuno = a.stuno
       ),0) AS "2020-1학기 등록금액",
       
       CASE WHEN (SELECT SCHREG_MOD_FG FROM ENRO200 WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno ) IN ('U030300017','U030300018') 
                 THEN (SELECT REG_TT_AMT FROM ENRO200 WHERE SCHYY || SHTM_FG = SF_TEMP202009_TEMP(a.stuno) AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno) 
                 ELSE 0 
       END AS "복귀생납부학기등록금",
       
       NVL((SELECT REG_TT_AMT FROM ENRO200 
        WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001'        
        AND stuno = a.stuno
       ),0) +       
       CASE WHEN (SELECT SCHREG_MOD_FG FROM ENRO200 WHERE SCHYY = '2020' AND SHTM_FG = 'U000200001' AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno ) IN ('U030300017','U030300018') 
                 THEN (SELECT REG_TT_AMT FROM ENRO200 WHERE SCHYY || SHTM_FG = SF_TEMP202009_TEMP(a.stuno) AND DETA_SHTM_FG = 'U000300001' AND stuno = a.stuno) 
                 ELSE 0 
       END AS "최종등록금액"       
       
FROM temp202009 a
--WHERE stuno = '2013-10260'
;

SELECT STUNO,
       SF_BSNS011_CODENM(A.SCHREG_MOD_FG,1), SCHREG_MOD_FG,       
       A.REG_TT_AMT,
       A.SCAL_TT_AMT,
       A.REG_TT_AMT - A.SCAL_TT_AMT
       --BF_RECIV_LSN_AMT,
       --BF_RECIV_SSO_AMT
FROM enro200 A
WHERE SCHYY = '2016'
AND SHTM_FG = 'U000200002'
AND deta_shtm_fg = 'U000300001'
AND stuno = '2013-10260'
;


SELECT SF_BSNS011_CODENM(A.SCHREG_MOD_FG,1), SCHREG_MOD_FG,       
       A.REG_TT_AMT - A.SCAL_TT_AMT,
       A.*
FROM enro200 A
WHERE SCHYY = '2020'
AND SHTM_FG = 'U000200001'
AND deta_shtm_fg = 'U000300001'
AND stuno = '2013-10260'
;

SELECT SF_BSNS011_CODENM(A.SCHREG_MOD_FG,1), SCHREG_MOD_FG,       
       A.REG_TT_AMT - A.SCAL_TT_AMT,
       A.*
FROM enro200 A
WHERE SCHYY = '2016'
AND SHTM_FG = 'U000200002'
AND deta_shtm_fg = 'U000300001'
AND stuno = '2013-10260'
;
 
SELECT CMMN_CD, KOR_NM, A.*
FROM BSNS011 A
WHERE A.GRP_CD = 'U0326'
ORDER BY A.DISP_ORD, A.CMMN_CD
;

SELECT CMMN_CD, KOR_NM, A.*
FROM BSNS011 A
WHERE a.USR_DEF_1 = 'U032600003'
;
